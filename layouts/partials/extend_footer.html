{{- /* 圆形阅读进度指示器 - 仅在文章页面显示 */ -}}
{{- if .IsPage }}
<div class="reading-progress-circle" id="reading-progress">
    <svg viewBox="0 0 60 60">
        <circle class="progress-bg" cx="30" cy="30" r="26"></circle>
        <circle class="progress-bar" cx="30" cy="30" r="26" id="progress-bar"></circle>
    </svg>
    <span class="progress-text" id="progress-text">0%</span>
</div>
<script>
(function() {
    const progressCircle = document.getElementById('reading-progress');
    const progressBar = document.getElementById('progress-bar');
    const progressText = document.getElementById('progress-text');
    
    if (!progressCircle || !progressBar) return;
    
    const circumference = 2 * Math.PI * 26; // r=26
    progressBar.style.strokeDasharray = circumference;
    progressBar.style.strokeDashoffset = circumference;
    
    function updateProgress() {
        const scrollTop = window.scrollY;
        const docHeight = document.documentElement.scrollHeight - window.innerHeight;
        const progress = docHeight > 0 ? (scrollTop / docHeight) * 100 : 0;
        
        // 滚动超过 100px 才显示
        if (scrollTop > 100) {
            progressCircle.classList.add('visible');
        } else {
            progressCircle.classList.remove('visible');
        }
        
        // 更新圆形进度
        const offset = circumference - (progress / 100) * circumference;
        progressBar.style.strokeDashoffset = offset;
        progressText.textContent = Math.round(progress) + '%';
        
        // 更新顶部进度条（非全屏模式）
        progressCircle.style.setProperty('--progress', progress + '%');
    }
    
    window.addEventListener('scroll', updateProgress);
    updateProgress();
})();
</script>
{{- end }}
